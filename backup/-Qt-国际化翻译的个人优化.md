# 前言

我在做医疗软件的时候经常需要翻译一些词条，以便软件售出国外。QT本身支持国际化翻译，但是是上下有关文法的方式，即同一个单词在不同的地方可以有不同的解释，但是对于医疗软件而言，它不需要这种方式，相反因为这个特点，导致每次在不同地方新增已经有过的翻译时还需要再次添加翻译语反而显得很麻烦。还有一个特点是Qt它只支持翻译在当前代码里明确提过的词句，这样导致每次翻译都需要在所需要翻译的地方额外添加代码以让Qt知道当前页面所需要翻译的词句。

# 处理

## 修改Qt为上下无关文法翻译方式

- 继承QTranslator然后重写translate函数，只需要将第一个参数固定，其余参数仍用传进来的参数即可

## 修改Qt的qm翻译配置文件生成方式

- 先通过生成ts文件，再通过Qt的工具生成qm文件
- ts文件主要包括标识，原文，对应的翻译
- 自行编写一个Qt程序，通过读取excel表里的数据生成一个或数个ts文件
- 再编写一个脚本，双击运行的时候，自动执行Qt程序把excel表里的数据转换成可用的ts文件，再遍历该路径下的所有ts文件，转换成qm文件

# 结论

- 代码会简洁很多，起码不再有需要明确提到需要翻译的词句
- 翻译工作可以交给其他非技术人员工作，不再需要麻烦技术人员
- 效率提高，所有的词句只需要翻译一遍即可

# 代码地址
https://github.com/2016317200404/work-essay/tree/main/translatorFromExcel
这个是写的翻译工具